package com.viplearner.api.services

import com.viplearner.api.client.BaseApiClient
import io.ktor.client.*
import io.ktor.client.engine.mock.*
import io.ktor.client.plugins.contentnegotiation.*
import io.ktor.http.*
import io.ktor.serialization.kotlinx.json.*
import io.ktor.utils.io.*
import kotlinx.coroutines.test.runTest
import kotlinx.serialization.json.Json
import kotlin.test.*

/**
 * Generated test file for AccountService
 *
 * This file was automatically generated by the test generator script.
 * It contains tests for all API endpoints in the AccountService service.
 *
 * Tests use MockEngine to simulate HTTP responses and verify requests.
 */
class AccountServiceTest {
    @BeforeTest
    fun setup() {
        // Setup will be customized per test with mock engine
    }

    @Test
    fun testAccountme() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "id": "bobby",
                            "username": "Bobby",
                            "perfs": {
                                        "bullet": {
                                                    "games": 510,
                                                    "rating": 1757,
                                                    "rd": 57,
                                                    "prog": -8
                                        },
                                        "blitz": {
                                                    "games": 61,
                                                    "rating": 1615,
                                                    "rd": 45,
                                                    "prog": -42
                                        },
                                        "rapid": {
                                                    "games": 222,
                                                    "rating": 1725,
                                                    "rd": 49,
                                                    "prog": 31
                                        },
                                        "classical": {
                                                    "games": 103,
                                                    "rating": 1758,
                                                    "rd": 111,
                                                    "prog": -31,
                                                    "prov": true
                                        },
                                        "correspondence": {
                                                    "games": 24,
                                                    "rating": 1734,
                                                    "rd": 45,
                                                    "prog": 15
                                        },
                                        "chess960": {
                                                    "games": 31,
                                                    "rating": 1631,
                                                    "rd": 48,
                                                    "prog": -16
                                        },
                                        "kingOfTheHill": {
                                                    "games": 38,
                                                    "rating": 1683,
                                                    "rd": 98,
                                                    "prog": 25
                                        },
                                        "threeCheck": {
                                                    "games": 7,
                                                    "rating": 1627,
                                                    "rd": 108,
                                                    "prog": -26
                                        },
                                        "antichess": {
                                                    "games": 219,
                                                    "rating": 1826,
                                                    "rd": 48,
                                                    "prog": -13
                                        },
                                        "atomic": {
                                                    "games": 29,
                                                    "rating": 1728,
                                                    "rd": 83,
                                                    "prog": -4
                                        },
                                        "horde": {
                                                    "games": 11,
                                                    "rating": 1809,
                                                    "rd": 53,
                                                    "prog": -44
                                        },
                                        "crazyhouse": {
                                                    "games": 351,
                                                    "rating": 1652,
                                                    "rd": 67,
                                                    "prog": -3
                                        },
                                        "puzzle": {
                                                    "games": 17,
                                                    "rating": 1614,
                                                    "rd": 112,
                                                    "prog": 22,
                                                    "prov": true
                                        }
                            },
                            "patron": true,
                            "patronColor": 1,
                            "createdAt": 1749204284150,
                            "profile": {
                                        "flag": "BV",
                                        "location": "Bobby City",
                                        "bio": "Price is the money-name of the labour realised in a commodity. Hence the expression of the equivalence of a commodity with the sum of money constituting its price, is a tautology,[14] just as in general the expression of the relative value of a commodity is a statement of the equivalence of two commodities. But although price, being the exponent of",
                                        "fideRating": 1725,
                                        "uscfRating": 1814,
                                        "ecfRating": 1564,
                                        "rcfRating": 1633,
                                        "cfcRating": 1721,
                                        "dsbRating": 1777,
                                        "links": "https://en.wikipedia.org/wiki/Srinivasa_Ramanujan\nhttps://lichess.org\nhttps://en.wikipedia.org/wiki/Euler"
                            },
                            "seenAt": 1757757502772,
                            "playTime": {
                                        "total": 16188,
                                        "tv": 0
                            },
                            "url": "https://lichess.org/@/Bobby",
                            "count": {
                                        "all": 2959,
                                        "rated": 2367,
                                        "ai": 0,
                                        "draw": 516,
                                        "drawH": 516,
                                        "loss": 1246,
                                        "lossH": 1246,
                                        "win": 1197,
                                        "winH": 1197,
                                        "bookmark": 0,
                                        "playing": 0,
                                        "import": 0,
                                        "me": 0
                            },
                            "followable": true,
                            "following": false,
                            "blocking": false
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/account
                    assertEquals("api/account", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/json"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = AccountService(testApiClient)

            // Act
            val result = testService.accountMe()

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: id
            // Verify field: username
            // Verify field: perfs

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testAccountemail() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "email": "bobby@localhost"
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/account/email
                    assertEquals("api/account/email", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/json"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = AccountService(testApiClient)

            // Act
            val result = testService.accountEmail()

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: email

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testAccount() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "prefs": {
                                        "dark": true,
                                        "transp": false,
                                        "bgImg": "https://lichess1.org/assets/lifat/background/gallery/bg19.webp",
                                        "is3d": false,
                                        "theme": "brown",
                                        "pieceSet": "cburnett",
                                        "theme3d": "Woodi",
                                        "pieceSet3d": "Basic",
                                        "soundSet": "standard",
                                        "autoQueen": 2,
                                        "autoThreefold": 3,
                                        "takeback": 3,
                                        "moretime": 3,
                                        "clockTenths": 1,
                                        "clockBar": true,
                                        "clockSound": true,
                                        "premove": true,
                                        "animation": 2,
                                        "pieceNotation": 0,
                                        "captured": true,
                                        "follow": true,
                                        "highlight": true,
                                        "destination": true,
                                        "coords": 1,
                                        "replay": 2,
                                        "challenge": 4,
                                        "message": 3,
                                        "submitMove": 0,
                                        "confirmResign": 1,
                                        "insightShare": 1,
                                        "keyboardMove": 0,
                                        "voiceMove": false,
                                        "zen": 0,
                                        "ratings": 1,
                                        "moveEvent": 2,
                                        "rookCastle": 1,
                                        "flairs": true,
                                        "sayGG": 0
                            },
                            "language": "en-US"
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/account/preferences
                    assertEquals("api/account/preferences", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/json"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = AccountService(testApiClient)

            // Act
            val result = testService.account()

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: prefs
            // Verify field: language

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testAccountkid() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "kid": false
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/account/kid
                    assertEquals("api/account/kid", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/json"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = AccountService(testApiClient)

            // Act
            val result = testService.accountKid()

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: kid

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testAccountkidpost() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "ok": true
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: POST api/account/kid
                    assertEquals("api/account/kid", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("POST"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/json"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = AccountService(testApiClient)

            // Act
            val result = testService.accountKidPost(v = false)

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: ok

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testTimeline_example0() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "entries": [
                                        {
                                                    "type": "follow",
                                                    "data": {
                                                                "u1": "patron11",
                                                                "u2": "jose"
                                                    },
                                                    "date": 1758634096293
                                        },
                                        {
                                                    "type": "team-join",
                                                    "data": {
                                                                "userId": "qing",
                                                                "teamId": "sacsacoops"
                                                    },
                                                    "date": 1758630695664
                                        },
                                        {
                                                    "type": "follow",
                                                    "data": {
                                                                "u1": "engine",
                                                                "u2": "nushi"
                                                    },
                                                    "date": 1758622370817
                                        },
                                        {
                                                    "type": "team-join",
                                                    "data": {
                                                                "userId": "benjamin",
                                                                "teamId": "anyway-heres-blunderwall"
                                                    },
                                                    "date": 1758618184685
                                        },
                                        {
                                                    "type": "team-join",
                                                    "data": {
                                                                "userId": "yaroslava",
                                                                "teamId": "captain-james-t-pirc"
                                                    },
                                                    "date": 1758617487558
                                        },
                                        {
                                                    "type": "follow",
                                                    "data": {
                                                                "u1": "nushi",
                                                                "u2": "aaron"
                                                    },
                                                    "date": 1758616944673
                                        },
                                        {
                                                    "type": "follow",
                                                    "data": {
                                                                "u1": "engine",
                                                                "u2": "sai"
                                                    },
                                                    "date": 1758587760345
                                        },
                                        {
                                                    "type": "follow",
                                                    "data": {
                                                                "u1": "patron11",
                                                                "u2": "ana"
                                                    },
                                                    "date": 1758575320624
                                        },
                                        {
                                                    "type": "follow",
                                                    "data": {
                                                                "u1": "nushi",
                                                                "u2": "bobby"
                                                    },
                                                    "date": 1758572527650
                                        },
                                        {
                                                    "type": "team-join",
                                                    "data": {
                                                                "userId": "kenneth",
                                                                "teamId": "the-fischermen"
                                                    },
                                                    "date": 1758557241244
                                        },
                                        {
                                                    "type": "follow",
                                                    "data": {
                                                                "u1": "qing",
                                                                "u2": "ana"
                                                    },
                                                    "date": 1758555872827
                                        },
                                        {
                                                    "type": "team-join",
                                                    "data": {
                                                                "userId": "nushi",
                                                                "teamId": "captain-james-t-pirc"
                                                    },
                                                    "date": 1758537737893
                                        }
                            ],
                            "users": {
                                        "kenneth": {
                                                    "name": "Kenneth",
                                                    "id": "kenneth"
                                        },
                                        "ana": {
                                                    "name": "Ana",
                                                    "title": "WNM",
                                                    "flair": "food-drink.ginger",
                                                    "id": "ana"
                                        },
                                        "aaron": {
                                                    "name": "Aaron",
                                                    "flair": "people.man-police-officer-medium-dark-skin-tone",
                                                    "id": "aaron"
                                        },
                                        "patron11": {
                                                    "name": "Patron11",
                                                    "patron": true,
                                                    "patronColor": 5,
                                                    "id": "patron11"
                                        },
                                        "jose": {
                                                    "name": "Jose",
                                                    "flair": "symbols.hole",
                                                    "id": "jose"
                                        },
                                        "yaroslava": {
                                                    "name": "Yaroslava",
                                                    "title": "FM",
                                                    "id": "yaroslava"
                                        },
                                        "benjamin": {
                                                    "name": "Benjamin",
                                                    "id": "benjamin"
                                        },
                                        "engine": {
                                                    "name": "Engine",
                                                    "flair": "people.backhand-index-pointing-up-medium-dark-skin-tone",
                                                    "id": "engine"
                                        },
                                        "qing": {
                                                    "name": "Qing",
                                                    "flair": "people.woman-lifting-weights-medium-skin-tone",
                                                    "patron": true,
                                                    "patronColor": 1,
                                                    "id": "qing"
                                        },
                                        "bobby": {
                                                    "name": "Bobby",
                                                    "patron": true,
                                                    "patronColor": 1,
                                                    "id": "bobby"
                                        },
                                        "nushi": {
                                                    "name": "Nushi",
                                                    "flair": "smileys.sleeping-face",
                                                    "patron": true,
                                                    "patronColor": 1,
                                                    "id": "nushi"
                                        },
                                        "sai": {
                                                    "name": "Sai",
                                                    "flair": "people.men-holding-hands",
                                                    "id": "sai"
                                        }
                            }
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/timeline
                    assertEquals("api/timeline", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/json"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = AccountService(testApiClient)

            // Act
            val result = testService.timeline()

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: entries
            // Verify field: users

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testTimeline_example1() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "entries": [
                                        {
                                                    "type": "follow",
                                                    "data": {
                                                                "u1": "neio",
                                                                "u2": "chess-network"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "team-join",
                                                    "data": {
                                                                "userId": "neio",
                                                                "teamId": "coders"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "team-create",
                                                    "data": {
                                                                "userId": "neio",
                                                                "teamId": "coders"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "forum-post",
                                                    "data": {
                                                                "userId": "neio",
                                                                "topicId": "AAAAAAAN",
                                                                "topicName": "World's Tallest LEGO Tower Completed in City Square",
                                                                "postId": "AAAAAAAL"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "ublog-post",
                                                    "data": {
                                                                "userId": "neio",
                                                                "id": "og5pkt1c",
                                                                "slug": "gotta-go-fast",
                                                                "title": "Gotta Go Fast"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "tour-join",
                                                    "data": {
                                                                "userId": "chess-network",
                                                                "tourId": "Z24oxqgU",
                                                                "tourName": "Daily Blitz Arena"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "game-end",
                                                    "data": {
                                                                "fullId": "iGkAXUdEfLZC",
                                                                "perf": "correspondence",
                                                                "opponent": "chess-network",
                                                                "win": false
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "simul-create",
                                                    "data": {
                                                                "userId": "neio",
                                                                "simulId": "m3c0Wvu3",
                                                                "simulName": "RCA 1st Jan simul"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "simul-join",
                                                    "data": {
                                                                "userId": "chess-network",
                                                                "simulId": "m3c0Wvu3",
                                                                "simulName": "RCA 1st Jan simul"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "study-like",
                                                    "data": {
                                                                "userId": "neio",
                                                                "studyId": "ma5AvZ7o",
                                                                "studyName": "Free wins | Danish Gambit"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "plan-start",
                                                    "data": {
                                                                "userId": "chess-network"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "plan-renew",
                                                    "data": {
                                                                "userId": "chess-network",
                                                                "months": 64
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "blog-post",
                                                    "data": {
                                                                "id": "ZUviXRIAACYAVtMm",
                                                                "slug": "lichess-development-made-easy-with-gitpod",
                                                                "title": "Lichess Development Made Easy With Gitpod"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "ublog-post-like",
                                                    "data": {
                                                                "userId": "neio",
                                                                "id": "ZUviXRIAACYAVtMm",
                                                                "title": "Lichess Development Made Easy With Gitpod"
                                                    },
                                                    "date": 1644232201429
                                        },
                                        {
                                                    "type": "stream-start",
                                                    "data": {
                                                                "id": "chess-network",
                                                                "title": "Streamers Battle December !team | lichess.org"
                                                    },
                                                    "date": 1644232201429
                                        }
                            ],
                            "users": {
                                        "neio": {
                                                    "id": "neio",
                                                    "name": "Neio",
                                                    "title": "NM"
                                        },
                                        "chess-network": {
                                                    "id": "chess-network",
                                                    "name": "Chess-Network",
                                                    "title": "NM",
                                                    "patron": true
                                        }
                            }
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/timeline
                    assertEquals("api/timeline", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/json"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = AccountService(testApiClient)

            // Act
            val result = testService.timeline()

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: entries
            // Verify field: users

            // Cleanup
            testApiClient.close()
        }
}
