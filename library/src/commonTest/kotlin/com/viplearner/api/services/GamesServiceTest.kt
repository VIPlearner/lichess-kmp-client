package com.viplearner.api.services

import com.viplearner.api.client.BaseApiClient
import io.ktor.client.*
import io.ktor.client.engine.mock.*
import io.ktor.client.plugins.contentnegotiation.*
import io.ktor.http.*
import io.ktor.serialization.kotlinx.json.*
import io.ktor.utils.io.*
import kotlinx.coroutines.test.runTest
import kotlinx.serialization.json.Json
import kotlin.test.*

/**
 * Generated test file for GamesService
 *
 * This file was automatically generated by the test generator script.
 * It contains tests for all API endpoints in the GamesService service.
 *
 * Tests use MockEngine to simulate HTTP responses and verify requests.
 */
class GamesServiceTest {
    @BeforeTest
    fun setup() {
        // Setup will be customized per test with mock engine
    }

    @Test
    fun testGamepgnAsPgn_example0() =
        runTest {
            val gameId = "mock"
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                "[Event \"Rated Blitz game\"]\n[Site \"https://lichess.org/fY44h4OY\"]\n[Date \"2018.03.29\"]\n[Round \"-\"]\n[White \"pveldman\"]\n[Black \"thibault\"]\n[Result \"1-0\"]\n[UTCDate \"2018.03.29\"]\n[UTCTime \"01:38:15\"]\n[WhiteElo \"1610\"]\n[BlackElo \"1601\"]\n[WhiteRatingDiff \"+10\"]\n[BlackRatingDiff \"-10\"]\n[Variant \"Standard\"]\n[TimeControl \"180+0\"]\n[ECO \"C62\"]\n[Opening \"Ruy Lopez: Steinitz Defense\"]\n[Termination \"Normal\"]\n\n1. e4 { [%clk 0:03:00] } e5 { [%clk 0:03:00] } 2. Nf3 { [%clk 0:02:59] } Nc6 { [%clk 0:02:58] } 3. Bb5 { [%clk 0:02:57] } d6 { [%clk 0:02:55] } 4. h3 { [%clk 0:02:54] } Nf6 { [%clk 0:02:52] } 5. Bxc6+ { [%clk 0:02:52] } bxc6 { [%clk 0:02:49] } 6. d3 { [%clk 0:02:51] } Be7 { [%clk 0:02:46] } 7. O-O { [%clk 0:02:47] } O-O { [%clk 0:02:45] } 8. b3 { [%clk 0:02:45] } d5 { [%clk 0:02:45] } 9. exd5 { [%clk 0:02:33] } cxd5 { [%clk 0:02:40] } 10. Nxe5 { [%clk 0:02:31] } Qd6 { [%clk 0:02:38] } 1-0\n"
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET game/export/${gameId}
                    assertEquals("game/export/$gameId", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    // Verify Accept header for PGN
                    assertEquals("application/x-chess-pgn", request.headers["Accept"])

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/x-chess-pgn"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.gamePgnAsPgn(gameId = "mock")

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            assertTrue(response.contains("Event"), "PGN should contain Event tag")
            assertTrue(response.contains("pveldman"), "PGN should contain player names")

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testGamepgnAsJson_example1() =
        runTest {
            val gameId = "mock"
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "id": "q7ZvsdUF",
                            "rated": true,
                            "variant": "standard",
                            "speed": "blitz",
                            "perf": "blitz",
                            "createdAt": 1514505150384,
                            "lastMoveAt": 1514505592843,
                            "status": "draw",
                            "source": "arena",
                            "players": {
                                        "white": {
                                                    "user": {
                                                                "name": "Lance5500",
                                                                "title": "LM",
                                                                "id": "lance5500"
                                                    },
                                                    "rating": 2389,
                                                    "ratingDiff": 4,
                                                    "analysis": {
                                                                "inaccuracy": 5,
                                                                "mistake": 2,
                                                                "blunder": 1,
                                                                "acpl": 26,
                                                                "accuracy": 90
                                                    }
                                        },
                                        "black": {
                                                    "user": {
                                                                "name": "TryingHard87",
                                                                "id": "tryinghard87"
                                                    },
                                                    "rating": 2498,
                                                    "ratingDiff": -4,
                                                    "analysis": {
                                                                "inaccuracy": 3,
                                                                "mistake": 3,
                                                                "blunder": 1,
                                                                "acpl": 26,
                                                                "accuracy": 90
                                                    }
                                        }
                            },
                            "opening": {
                                        "eco": "D31",
                                        "name": "Semi-Slav Defense: Marshall Gambit",
                                        "ply": 7
                            },
                            "moves": "d4 d5 c4 c6 Nc3 e6 e4 Nd7 exd5 cxd5 cxd5 exd5 Nxd5 Nb6 Bb5+ Bd7 Qe2+ Ne7 Nxb6 Qxb6 Bxd7+ Kxd7 Nf3 Qa6 Ne5+ Ke8 Qf3 f6 Nd3 Qc6 Qe2 Kf7 O-O Kg8 Bd2 Re8 Rac1 Nf5 Be3 Qe6 Rfe1 g6 b3 Bd6 Qd2 Kf7 Bf4 Qd7 Bxd6 Nxd6 Nc5 Rxe1+ Rxe1 Qc6 f3 Re8 Rxe8 Nxe8 Kf2 Nc7 Qb4 b6 Qc4+ Nd5 Nd3 Qe6 Nb4 Ne7 Qxe6+ Kxe6 Ke3 Kd6 g3 h6 Kd3 h5 Nc2 Kd5 a3 Nc6 Ne3+ Kd6 h4 Nd8 g4 Ne6 Ke4 Ng7 Nc4+ Ke6 d5+ Kd7 a4 g5 gxh5 Nxh5 hxg5 fxg5 Kf5 Nf4 Ne3 Nh3 Kg4 Ng1 Nc4 Kc7 Nd2 Kd6 Kxg5 Kxd5 f4 Nh3+ Kg4 Nf2+ Kf3 Nd3 Ke3 Nc5 Kf3 Ke6 Ke3 Kf5 Kd4 Ne6+ Kc4",
                            "analysis": [
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 7
                                        },
                                        {
                                                    "eval": 10
                                        },
                                        {
                                                    "eval": 14
                                        },
                                        {
                                                    "eval": 2
                                        },
                                        {
                                                    "eval": 9
                                        },
                                        {
                                                    "eval": 5
                                        },
                                        {
                                                    "eval": 85,
                                                    "best": "d5e4",
                                                    "variation": "dxe4 Nxe4 Bb4+ Nc3 c5 a3 Bxc3+ bxc3 Nc6 Nf3",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. dxe4 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 96
                                        },
                                        {
                                                    "eval": 98
                                        },
                                        {
                                                    "eval": 88
                                        },
                                        {
                                                    "eval": 87
                                        },
                                        {
                                                    "eval": 81
                                        },
                                        {
                                                    "eval": 88
                                        },
                                        {
                                                    "eval": 82
                                        },
                                        {
                                                    "eval": 90
                                        },
                                        {
                                                    "eval": 79
                                        },
                                        {
                                                    "eval": 160,
                                                    "best": "f8e7",
                                                    "variation": "Be7 Nxb6 axb6 Nf3 Nf6 O-O O-O Bd2 Bd6 Bc4 Re8 Qd3 Be6 Bxe6",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Be7 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 146
                                        },
                                        {
                                                    "eval": 151
                                        },
                                        {
                                                    "eval": 149
                                        },
                                        {
                                                    "eval": 160
                                        },
                                        {
                                                    "eval": 151
                                        },
                                        {
                                                    "eval": 150
                                        },
                                        {
                                                    "eval": 164
                                        },
                                        {
                                                    "eval": 190
                                        },
                                        {
                                                    "eval": 44,
                                                    "best": "e5d3",
                                                    "variation": "Nd3 Rd8",
                                                    "judgment": {
                                                                "name": "Mistake",
                                                                "comment": "Mistake. Nd3 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 61
                                        },
                                        {
                                                    "eval": 59
                                        },
                                        {
                                                    "eval": 54
                                        },
                                        {
                                                    "eval": -34,
                                                    "best": "e1e2",
                                                    "variation": "Ke2 Rd8 Rd1 Qxf3+ Kxf3 Nf5 Be3 Nh4+ Kg3 g5 f4 gxf4+ Bxf4 Nf5+",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Ke2 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 158,
                                                    "best": "c6g2",
                                                    "variation": "Qxg2 Rf1 Qd5 Be3 Rc8 Nf4 Qf5 Rc1 Rxc1+ Bxc1 g5 Ne6 Kf7 Nd8+",
                                                    "judgment": {
                                                                "name": "Blunder",
                                                                "comment": "Blunder. Qxg2 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 142
                                        },
                                        {
                                                    "eval": 183
                                        },
                                        {
                                                    "eval": 177
                                        },
                                        {
                                                    "eval": 340,
                                                    "best": "e7d5",
                                                    "variation": "Nd5 Rac1 Qe8 Qf3 Rd8 Nf4 Qf7 Nxd5 Qxd5 Qxd5+ Rxd5 Rc7 Rxd4 Bc3",
                                                    "judgment": {
                                                                "name": "Mistake",
                                                                "comment": "Mistake. Nd5 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 169,
                                                    "best": "f1e1",
                                                    "variation": "Rfe1 Rc8 Rac1 Qd7 Nf4 Rxc1 Rxc1 h5 Qd3 a5 Qb3+ Kh7 Rc5 Nf5",
                                                    "judgment": {
                                                                "name": "Mistake",
                                                                "comment": "Mistake. Rfe1 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 200
                                        },
                                        {
                                                    "eval": 120,
                                                    "best": "e2h5",
                                                    "variation": "Qh5 Qd7 Rc7 Qxc7 Qxe8 Qc6 Qd8 h6 Bb4 Qe4 Ne1 Kf7 Nf3 Qc6",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Qh5 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 167
                                        },
                                        {
                                                    "eval": 147
                                        },
                                        {
                                                    "eval": 200,
                                                    "best": "e6d7",
                                                    "variation": "Qd7 Nf4"
                                        },
                                        {
                                                    "eval": 92,
                                                    "best": "c1c7",
                                                    "variation": "Rc7 Qxa2",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Rc7 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 102
                                        },
                                        {
                                                    "eval": 95
                                        },
                                        {
                                                    "eval": 95
                                        },
                                        {
                                                    "eval": 61
                                        },
                                        {
                                                    "eval": 79
                                        },
                                        {
                                                    "eval": 72
                                        },
                                        {
                                                    "eval": 201,
                                                    "best": "d7d6",
                                                    "variation": "Qxd6 d5 Rxe1+ Rxe1 Re8 Rxe8 Kxe8 Nf4 Qe5 g3 Nd4 Qc3 Kd7 Qb4",
                                                    "judgment": {
                                                                "name": "Mistake",
                                                                "comment": "Mistake. Qxd6 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 190
                                        },
                                        {
                                                    "eval": 183
                                        },
                                        {
                                                    "eval": 106,
                                                    "best": "d2e1",
                                                    "variation": "Qxe1 Qe7 Qxe7+ Kxe7 Nxb7 Rc8 Re1+ Kd7 Nc5+ Kc6 g3 Re8 Rc1 Kd5",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Qxe1 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 108
                                        },
                                        {
                                                    "eval": 93
                                        },
                                        {
                                                    "eval": 101
                                        },
                                        {
                                                    "eval": 101
                                        },
                                        {
                                                    "eval": 107
                                        },
                                        {
                                                    "eval": 100
                                        },
                                        {
                                                    "eval": 105
                                        },
                                        {
                                                    "eval": 103
                                        },
                                        {
                                                    "eval": 118
                                        },
                                        {
                                                    "eval": 117
                                        },
                                        {
                                                    "eval": 116
                                        },
                                        {
                                                    "eval": 83
                                        },
                                        {
                                                    "eval": 95
                                        },
                                        {
                                                    "eval": 90
                                        },
                                        {
                                                    "eval": 94
                                        },
                                        {
                                                    "eval": 94
                                        },
                                        {
                                                    "eval": 93
                                        },
                                        {
                                                    "eval": 88
                                        },
                                        {
                                                    "eval": 102
                                        },
                                        {
                                                    "eval": 79
                                        },
                                        {
                                                    "eval": 120
                                        },
                                        {
                                                    "eval": 114
                                        },
                                        {
                                                    "eval": 124
                                        },
                                        {
                                                    "eval": 108
                                        },
                                        {
                                                    "eval": 133
                                        },
                                        {
                                                    "eval": 100
                                        },
                                        {
                                                    "eval": 156,
                                                    "best": "d5d6",
                                                    "variation": "Kd6 Kc4"
                                        },
                                        {
                                                    "eval": 198
                                        },
                                        {
                                                    "eval": 179
                                        },
                                        {
                                                    "eval": 167
                                        },
                                        {
                                                    "eval": 227,
                                                    "best": "c6a5",
                                                    "variation": "Na5 b4"
                                        },
                                        {
                                                    "eval": 225
                                        },
                                        {
                                                    "eval": 209
                                        },
                                        {
                                                    "eval": 207
                                        },
                                        {
                                                    "eval": 192
                                        },
                                        {
                                                    "eval": 173
                                        },
                                        {
                                                    "eval": 243,
                                                    "best": "d6c6",
                                                    "variation": "Kc6 a4 a6 Ne3 Kd6 d5 Kd7 Kd4 Ne8 gxh5 gxh5 Nf5 Nd6 Ng3",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Kc6 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 219
                                        },
                                        {
                                                    "eval": 234
                                        },
                                        {
                                                    "eval": 201
                                        },
                                        {
                                                    "eval": 342,
                                                    "best": "d7e7",
                                                    "variation": "Ke7 Kf4 Ne8 g5 Kf7 gxf6 Kxf6 Nd2 Ng7 Ne4+ Ke7 Kg5 Nf5 d6+",
                                                    "judgment": {
                                                                "name": "Mistake",
                                                                "comment": "Mistake. Ke7 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 318
                                        },
                                        {
                                                    "eval": 342
                                        },
                                        {
                                                    "eval": 307
                                        },
                                        {
                                                    "eval": 323
                                        },
                                        {
                                                    "eval": 270
                                        },
                                        {
                                                    "eval": 313
                                        },
                                        {
                                                    "eval": 279
                                        },
                                        {
                                                    "eval": 303
                                        },
                                        {
                                                    "eval": 286
                                        },
                                        {
                                                    "eval": 277
                                        },
                                        {
                                                    "eval": 215
                                        },
                                        {
                                                    "eval": 213
                                        },
                                        {
                                                    "eval": 8,
                                                    "best": "b3b4",
                                                    "variation": "b4 Kc8 Nd6+ Kd7 Ne4 a6 Nc3 Kd6 Kg3 Ke5 b5 axb5 axb5 Kd6",
                                                    "judgment": {
                                                                "name": "Blunder",
                                                                "comment": "Blunder. b4 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 21
                                        },
                                        {
                                                    "eval": 54
                                        },
                                        {
                                                    "eval": 42
                                        },
                                        {
                                                    "eval": 57
                                        },
                                        {
                                                    "eval": 25
                                        },
                                        {
                                                    "eval": 63
                                        },
                                        {
                                                    "eval": 8,
                                                    "best": "f3g4",
                                                    "variation": "Kg4 Nf2+ Kf5 Kd4 Nf3+ Kc3 Ke6 Kxb3 f5 Ne4 Ke5 Nf2 Kf4 Nd3+",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Kg4 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 8
                                        }
                            ],
                            "tournament": "winter17",
                            "clock": {
                                        "initial": 300,
                                        "increment": 3,
                                        "totalTime": 420
                            },
                            "division": {
                                        "middle": 22,
                                        "end": 53
                            }
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET game/export/${gameId}
                    assertEquals("game/export/$gameId", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/json"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.gamePgnAsJson(gameId = "mock")

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: id
            assertEquals("q7ZvsdUF", response.id)
            // Verify field: rated
            assertTrue(response.rated)
            // Verify field: variant
            assertEquals(com.viplearner.api.models.VariantKey.STANDARD, response.variant)

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testUsercurrentgameAsPgn_example0() =
        runTest {
            val username = "mock"
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                "[Event \"Rated Blitz game\"]\n[Site \"https://lichess.org/fY44h4OY\"]\n[Date \"2018.03.29\"]\n[Round \"-\"]\n[White \"pveldman\"]\n[Black \"thibault\"]\n[Result \"1-0\"]\n[UTCDate \"2018.03.29\"]\n[UTCTime \"01:38:15\"]\n[WhiteElo \"1610\"]\n[BlackElo \"1601\"]\n[WhiteRatingDiff \"+10\"]\n[BlackRatingDiff \"-10\"]\n[Variant \"Standard\"]\n[TimeControl \"180+0\"]\n[ECO \"C62\"]\n[Opening \"Ruy Lopez: Steinitz Defense\"]\n[Termination \"Normal\"]\n\n1. e4 { [%clk 0:03:00] } e5 { [%clk 0:03:00] } 2. Nf3 { [%clk 0:02:59] } Nc6 { [%clk 0:02:58] } 3. Bb5 { [%clk 0:02:57] } d6 { [%clk 0:02:55] } 4. h3 { [%clk 0:02:54] } Nf6 { [%clk 0:02:52] } 5. Bxc6+ { [%clk 0:02:52] } bxc6 { [%clk 0:02:49] } 6. d3 { [%clk 0:02:51] } Be7 { [%clk 0:02:46] } 7. O-O { [%clk 0:02:47] } O-O { [%clk 0:02:45] } 8. b3 { [%clk 0:02:45] } d5 { [%clk 0:02:45] } 9. exd5 { [%clk 0:02:33] } cxd5 { [%clk 0:02:40] } 10. Nxe5 { [%clk 0:02:31] } Qd6 { [%clk 0:02:38] } 1-0\n"
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/user/${username}/current-game
                    assertEquals("api/user/$username/current-game", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    // Verify Accept header for PGN
                    assertEquals("application/x-chess-pgn", request.headers["Accept"])

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/x-chess-pgn"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.userCurrentGameAsPgn(username = "mock")

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            assertTrue(response.contains("Event"), "PGN should contain Event tag")
            assertTrue(response.contains("pveldman"), "PGN should contain player names")

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testUsercurrentgameAsJson_example1() =
        runTest {
            val username = "mock"
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "id": "8y40iLEJ",
                            "rated": true,
                            "variant": "standard",
                            "speed": "blitz",
                            "perf": "blitz",
                            "createdAt": 1758409631392,
                            "lastMoveAt": 1758409826541,
                            "status": "mate",
                            "source": "pool",
                            "players": {
                                        "white": {
                                                    "user": {
                                                                "name": "fiancheeto_bishop",
                                                                "id": "fiancheeto_bishop"
                                                    },
                                                    "rating": 2775,
                                                    "ratingDiff": 3,
                                                    "analysis": {
                                                                "inaccuracy": 3,
                                                                "mistake": 0,
                                                                "blunder": 0,
                                                                "acpl": 18,
                                                                "accuracy": 94
                                                    }
                                        },
                                        "black": {
                                                    "user": {
                                                                "name": "Lance5500",
                                                                "title": "LM",
                                                                "id": "lance5500"
                                                    },
                                                    "rating": 2596,
                                                    "ratingDiff": -3,
                                                    "analysis": {
                                                                "inaccuracy": 4,
                                                                "mistake": 1,
                                                                "blunder": 1,
                                                                "acpl": 43,
                                                                "accuracy": 87
                                                    }
                                        }
                            },
                            "winner": "white",
                            "opening": {
                                        "eco": "B56",
                                        "name": "Sicilian Defense: Classical Variation",
                                        "ply": 10
                            },
                            "moves": "e4 c5 Nc3 Nc6 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nb3 g6 Be2 Bg7 O-O O-O Bg5 a5 a4 Be6 Re1 h6 Be3 Kh7 Rb1 Rc8 Bb5 Nb4 Nd4 Bc4 f3 Bxb5 Ndxb5 Nd7 Re2 Ne5 Bd4 Nec6 Bxg7 Kxg7 b3 Qb6+ Kh1 Qc5 Qe1 Rfe8 Rd1 Na7 Nxa7 Qxa7 Nb5 Qc5 c3 Nc6 Rd5 Qb6 h4 Na7 h5 Nxb5 Rxb5 Qc6 c4 b6 hxg6 fxg6 e5 Rf8 exd6 exd6 Qc3+ Kg8 Qe3 Rce8 Qxh6 Rxe2 Qxg6+ Kh8 Rh5#",
                            "analysis": [
                                        {
                                                    "eval": 18
                                        },
                                        {
                                                    "eval": 24
                                        },
                                        {
                                                    "eval": 26
                                        },
                                        {
                                                    "eval": 23
                                        },
                                        {
                                                    "eval": 19
                                        },
                                        {
                                                    "eval": 41
                                        },
                                        {
                                                    "eval": 32
                                        },
                                        {
                                                    "eval": 34
                                        },
                                        {
                                                    "eval": 39
                                        },
                                        {
                                                    "eval": 30
                                        },
                                        {
                                                    "eval": 18
                                        },
                                        {
                                                    "eval": 17
                                        },
                                        {
                                                    "eval": 1
                                        },
                                        {
                                                    "eval": 0
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 4
                                        },
                                        {
                                                    "eval": -3
                                        },
                                        {
                                                    "eval": 28
                                        },
                                        {
                                                    "eval": 31
                                        },
                                        {
                                                    "eval": 36
                                        },
                                        {
                                                    "eval": 18
                                        },
                                        {
                                                    "eval": 16
                                        },
                                        {
                                                    "eval": 17
                                        },
                                        {
                                                    "eval": 43
                                        },
                                        {
                                                    "eval": 23
                                        },
                                        {
                                                    "eval": 22
                                        },
                                        {
                                                    "eval": -30
                                        },
                                        {
                                                    "eval": 20
                                        },
                                        {
                                                    "eval": 20
                                        },
                                        {
                                                    "eval": 46
                                        },
                                        {
                                                    "eval": -24,
                                                    "best": "b5c4",
                                                    "variation": "Bxc4 Rxc4 f3 e5 Ndb5 d5 Qe2 Rc6 exd5 Nbxd5 Nxd5 Qxd5",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Bxc4 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 65,
                                                    "best": "e7e5",
                                                    "variation": "e5",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. e5 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 48
                                        },
                                        {
                                                    "eval": 68
                                        },
                                        {
                                                    "eval": 58
                                        },
                                        {
                                                    "eval": 68
                                        },
                                        {
                                                    "eval": 94
                                        },
                                        {
                                                    "eval": 115
                                        },
                                        {
                                                    "eval": 122
                                        },
                                        {
                                                    "eval": 109
                                        },
                                        {
                                                    "eval": 71
                                        },
                                        {
                                                    "eval": 69
                                        },
                                        {
                                                    "eval": 66
                                        },
                                        {
                                                    "eval": 96
                                        },
                                        {
                                                    "eval": 9,
                                                    "best": "c3d5",
                                                    "variation": "Nd5 e6",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Nd5 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 82,
                                                    "best": "c8d8",
                                                    "variation": "Rcd8",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Rcd8 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 79
                                        },
                                        {
                                                    "eval": 88
                                        },
                                        {
                                                    "eval": 85
                                        },
                                        {
                                                    "eval": 91
                                        },
                                        {
                                                    "eval": 83
                                        },
                                        {
                                                    "eval": 102
                                        },
                                        {
                                                    "eval": 94
                                        },
                                        {
                                                    "eval": 96
                                        },
                                        {
                                                    "eval": 79
                                        },
                                        {
                                                    "eval": 86
                                        },
                                        {
                                                    "eval": 56
                                        },
                                        {
                                                    "eval": 77
                                        },
                                        {
                                                    "eval": 82
                                        },
                                        {
                                                    "eval": 177,
                                                    "best": "e7e6",
                                                    "variation": "e6",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. e6 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 171
                                        },
                                        {
                                                    "eval": 211
                                        },
                                        {
                                                    "eval": 207
                                        },
                                        {
                                                    "eval": 220
                                        },
                                        {
                                                    "eval": 203
                                        },
                                        {
                                                    "eval": 216
                                        },
                                        {
                                                    "eval": 212
                                        },
                                        {
                                                    "eval": 439,
                                                    "best": "c8d8",
                                                    "variation": "Rcd8 exd6 Rxd6 Rxe7+ Kf8 Ree5 Kf7 f4 Qd7 Rbd5 Rxd5 cxd5",
                                                    "judgment": {
                                                                "name": "Mistake",
                                                                "comment": "Mistake. Rcd8 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 426
                                        },
                                        {
                                                    "eval": 424
                                        },
                                        {
                                                    "eval": 385
                                        },
                                        {
                                                    "eval": 553,
                                                    "best": "g7f7",
                                                    "variation": "Kf7 Qd4 Rce8 Rxe8 Qxe8 Kh2 Qe1 Rxb6 Qe5+ Qxe5 dxe5 Rb5",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Kf7 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 362,
                                                    "best": "e2e6",
                                                    "variation": "Re6 Qd7 Rxg6+ Kh7 Qd3 Rc5 Rxd6+ Qf5 Qxf5+ Rcxf5 Rdxb6 R8f6",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Re6 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 347
                                        },
                                        {
                                                    "eval": 357
                                        },
                                        {
                                                    "mate": 2,
                                                    "best": "g8f7",
                                                    "variation": "Kf7 Qf4+ Kg8 Qg5 Kf7 Re3 Qc7 Qd5+ Kg7 Qd4+ Kh7 Kg1",
                                                    "judgment": {
                                                                "name": "Blunder",
                                                                "comment": "Checkmate is now unavoidable. Kf7 was best."
                                                    }
                                        },
                                        {
                                                    "mate": 1
                                        },
                                        {
                                                    "mate": 1
                                        }
                            ],
                            "clock": {
                                        "initial": 180,
                                        "increment": 0,
                                        "totalTime": 180
                            },
                            "division": {
                                        "middle": 24,
                                        "end": 61
                            }
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/user/${username}/current-game
                    assertEquals("api/user/$username/current-game", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/json"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.userCurrentGameAsJson(username = "mock")

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: id
            // Verify field: rated
            // Verify field: variant

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testGamesuser_example0() =
        runTest {
            val username = "mock"
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                "[Event \"Rated Blitz game\"]\n[Site \"https://lichess.org/fY44h4OY\"]\n[Date \"2018.03.29\"]\n[Round \"-\"]\n[White \"pveldman\"]\n[Black \"thibault\"]\n[Result \"1-0\"]\n[UTCDate \"2018.03.29\"]\n[UTCTime \"01:38:15\"]\n[WhiteElo \"1610\"]\n[BlackElo \"1601\"]\n[WhiteRatingDiff \"+10\"]\n[BlackRatingDiff \"-10\"]\n[Variant \"Standard\"]\n[TimeControl \"180+0\"]\n[ECO \"C62\"]\n[Opening \"Ruy Lopez: Steinitz Defense\"]\n[Termination \"Normal\"]\n\n1. e4 { [%clk 0:03:00] } e5 { [%clk 0:03:00] } 2. Nf3 { [%clk 0:02:59] } Nc6 { [%clk 0:02:58] } 3. Bb5 { [%clk 0:02:57] } d6 { [%clk 0:02:55] } 4. h3 { [%clk 0:02:54] } Nf6 { [%clk 0:02:52] } 5. Bxc6+ { [%clk 0:02:52] } bxc6 { [%clk 0:02:49] } 6. d3 { [%clk 0:02:51] } Be7 { [%clk 0:02:46] } 7. O-O { [%clk 0:02:47] } O-O { [%clk 0:02:45] } 8. b3 { [%clk 0:02:45] } d5 { [%clk 0:02:45] } 9. exd5 { [%clk 0:02:33] } cxd5 { [%clk 0:02:40] } 10. Nxe5 { [%clk 0:02:31] } Qd6 { [%clk 0:02:38] } 1-0\n"
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/games/user/${username}
                    assertEquals("api/games/user/$username", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/x-chess-pgn"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.gamesUser(username = "mock")

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Add specific field assertions here

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testGamesuser_example1() =
        runTest {
            val username = "mock"
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "id": "8y40iLEJ",
                            "rated": true,
                            "variant": "standard",
                            "speed": "blitz",
                            "perf": "blitz",
                            "createdAt": 1758409631392,
                            "lastMoveAt": 1758409826541,
                            "status": "mate",
                            "source": "pool",
                            "players": {
                                        "white": {
                                                    "user": {
                                                                "name": "fiancheeto_bishop",
                                                                "id": "fiancheeto_bishop"
                                                    },
                                                    "rating": 2775,
                                                    "ratingDiff": 3,
                                                    "analysis": {
                                                                "inaccuracy": 3,
                                                                "mistake": 0,
                                                                "blunder": 0,
                                                                "acpl": 18,
                                                                "accuracy": 94
                                                    }
                                        },
                                        "black": {
                                                    "user": {
                                                                "name": "Lance5500",
                                                                "title": "LM",
                                                                "id": "lance5500"
                                                    },
                                                    "rating": 2596,
                                                    "ratingDiff": -3,
                                                    "analysis": {
                                                                "inaccuracy": 4,
                                                                "mistake": 1,
                                                                "blunder": 1,
                                                                "acpl": 43,
                                                                "accuracy": 87
                                                    }
                                        }
                            },
                            "winner": "white",
                            "opening": {
                                        "eco": "B56",
                                        "name": "Sicilian Defense: Classical Variation",
                                        "ply": 10
                            },
                            "moves": "e4 c5 Nc3 Nc6 Nf3 d6 d4 cxd4 Nxd4 Nf6 Nb3 g6 Be2 Bg7 O-O O-O Bg5 a5 a4 Be6 Re1 h6 Be3 Kh7 Rb1 Rc8 Bb5 Nb4 Nd4 Bc4 f3 Bxb5 Ndxb5 Nd7 Re2 Ne5 Bd4 Nec6 Bxg7 Kxg7 b3 Qb6+ Kh1 Qc5 Qe1 Rfe8 Rd1 Na7 Nxa7 Qxa7 Nb5 Qc5 c3 Nc6 Rd5 Qb6 h4 Na7 h5 Nxb5 Rxb5 Qc6 c4 b6 hxg6 fxg6 e5 Rf8 exd6 exd6 Qc3+ Kg8 Qe3 Rce8 Qxh6 Rxe2 Qxg6+ Kh8 Rh5#",
                            "analysis": [
                                        {
                                                    "eval": 18
                                        },
                                        {
                                                    "eval": 24
                                        },
                                        {
                                                    "eval": 26
                                        },
                                        {
                                                    "eval": 23
                                        },
                                        {
                                                    "eval": 19
                                        },
                                        {
                                                    "eval": 41
                                        },
                                        {
                                                    "eval": 32
                                        },
                                        {
                                                    "eval": 34
                                        },
                                        {
                                                    "eval": 39
                                        },
                                        {
                                                    "eval": 30
                                        },
                                        {
                                                    "eval": 18
                                        },
                                        {
                                                    "eval": 17
                                        },
                                        {
                                                    "eval": 1
                                        },
                                        {
                                                    "eval": 0
                                        },
                                        {
                                                    "eval": 8
                                        },
                                        {
                                                    "eval": 4
                                        },
                                        {
                                                    "eval": -3
                                        },
                                        {
                                                    "eval": 28
                                        },
                                        {
                                                    "eval": 31
                                        },
                                        {
                                                    "eval": 36
                                        },
                                        {
                                                    "eval": 18
                                        },
                                        {
                                                    "eval": 16
                                        },
                                        {
                                                    "eval": 17
                                        },
                                        {
                                                    "eval": 43
                                        },
                                        {
                                                    "eval": 23
                                        },
                                        {
                                                    "eval": 22
                                        },
                                        {
                                                    "eval": -30
                                        },
                                        {
                                                    "eval": 20
                                        },
                                        {
                                                    "eval": 20
                                        },
                                        {
                                                    "eval": 46
                                        },
                                        {
                                                    "eval": -24,
                                                    "best": "b5c4",
                                                    "variation": "Bxc4 Rxc4 f3 e5 Ndb5 d5 Qe2 Rc6 exd5 Nbxd5 Nxd5 Qxd5",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Bxc4 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 65,
                                                    "best": "e7e5",
                                                    "variation": "e5",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. e5 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 48
                                        },
                                        {
                                                    "eval": 68
                                        },
                                        {
                                                    "eval": 58
                                        },
                                        {
                                                    "eval": 68
                                        },
                                        {
                                                    "eval": 94
                                        },
                                        {
                                                    "eval": 115
                                        },
                                        {
                                                    "eval": 122
                                        },
                                        {
                                                    "eval": 109
                                        },
                                        {
                                                    "eval": 71
                                        },
                                        {
                                                    "eval": 69
                                        },
                                        {
                                                    "eval": 66
                                        },
                                        {
                                                    "eval": 96
                                        },
                                        {
                                                    "eval": 9,
                                                    "best": "c3d5",
                                                    "variation": "Nd5 e6",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Nd5 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 82,
                                                    "best": "c8d8",
                                                    "variation": "Rcd8",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Rcd8 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 79
                                        },
                                        {
                                                    "eval": 88
                                        },
                                        {
                                                    "eval": 85
                                        },
                                        {
                                                    "eval": 91
                                        },
                                        {
                                                    "eval": 83
                                        },
                                        {
                                                    "eval": 102
                                        },
                                        {
                                                    "eval": 94
                                        },
                                        {
                                                    "eval": 96
                                        },
                                        {
                                                    "eval": 79
                                        },
                                        {
                                                    "eval": 86
                                        },
                                        {
                                                    "eval": 56
                                        },
                                        {
                                                    "eval": 77
                                        },
                                        {
                                                    "eval": 82
                                        },
                                        {
                                                    "eval": 177,
                                                    "best": "e7e6",
                                                    "variation": "e6",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. e6 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 171
                                        },
                                        {
                                                    "eval": 211
                                        },
                                        {
                                                    "eval": 207
                                        },
                                        {
                                                    "eval": 220
                                        },
                                        {
                                                    "eval": 203
                                        },
                                        {
                                                    "eval": 216
                                        },
                                        {
                                                    "eval": 212
                                        },
                                        {
                                                    "eval": 439,
                                                    "best": "c8d8",
                                                    "variation": "Rcd8 exd6 Rxd6 Rxe7+ Kf8 Ree5 Kf7 f4 Qd7 Rbd5 Rxd5 cxd5",
                                                    "judgment": {
                                                                "name": "Mistake",
                                                                "comment": "Mistake. Rcd8 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 426
                                        },
                                        {
                                                    "eval": 424
                                        },
                                        {
                                                    "eval": 385
                                        },
                                        {
                                                    "eval": 553,
                                                    "best": "g7f7",
                                                    "variation": "Kf7 Qd4 Rce8 Rxe8 Qxe8 Kh2 Qe1 Rxb6 Qe5+ Qxe5 dxe5 Rb5",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Kf7 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 362,
                                                    "best": "e2e6",
                                                    "variation": "Re6 Qd7 Rxg6+ Kh7 Qd3 Rc5 Rxd6+ Qf5 Qxf5+ Rcxf5 Rdxb6 R8f6",
                                                    "judgment": {
                                                                "name": "Inaccuracy",
                                                                "comment": "Inaccuracy. Re6 was best."
                                                    }
                                        },
                                        {
                                                    "eval": 347
                                        },
                                        {
                                                    "eval": 357
                                        },
                                        {
                                                    "mate": 2,
                                                    "best": "g8f7",
                                                    "variation": "Kf7 Qf4+ Kg8 Qg5 Kf7 Re3 Qc7 Qd5+ Kg7 Qd4+ Kh7 Kg1",
                                                    "judgment": {
                                                                "name": "Blunder",
                                                                "comment": "Checkmate is now unavoidable. Kf7 was best."
                                                    }
                                        },
                                        {
                                                    "mate": 1
                                        },
                                        {
                                                    "mate": 1
                                        }
                            ],
                            "clock": {
                                        "initial": 180,
                                        "increment": 0,
                                        "totalTime": 180
                            },
                            "division": {
                                        "middle": 24,
                                        "end": 61
                            }
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/games/user/${username}
                    assertEquals("api/games/user/$username", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/x-ndjson"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.gamesUser(username = "mock")

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: id
            // Verify field: rated
            // Verify field: variant

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testGamesexportids_example0() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                "[Event \"Rated Blitz game\"]\n[Site \"https://lichess.org/fY44h4OY\"]\n[Date \"2018.03.29\"]\n[Round \"-\"]\n[White \"pveldman\"]\n[Black \"thibault\"]\n[Result \"1-0\"]\n[UTCDate \"2018.03.29\"]\n[UTCTime \"01:38:15\"]\n[WhiteElo \"1610\"]\n[BlackElo \"1601\"]\n[WhiteRatingDiff \"+10\"]\n[BlackRatingDiff \"-10\"]\n[Variant \"Standard\"]\n[TimeControl \"180+0\"]\n[ECO \"C62\"]\n[Opening \"Ruy Lopez: Steinitz Defense\"]\n[Termination \"Normal\"]\n\n1. e4 { [%clk 0:03:00] } e5 { [%clk 0:03:00] } 2. Nf3 { [%clk 0:02:59] } Nc6 { [%clk 0:02:58] } 3. Bb5 { [%clk 0:02:57] } d6 { [%clk 0:02:55] } 4. h3 { [%clk 0:02:54] } Nf6 { [%clk 0:02:52] } 5. Bxc6+ { [%clk 0:02:52] } bxc6 { [%clk 0:02:49] } 6. d3 { [%clk 0:02:51] } Be7 { [%clk 0:02:46] } 7. O-O { [%clk 0:02:47] } O-O { [%clk 0:02:45] } 8. b3 { [%clk 0:02:45] } d5 { [%clk 0:02:45] } 9. exd5 { [%clk 0:02:33] } cxd5 { [%clk 0:02:40] } 10. Nxe5 { [%clk 0:02:31] } Qd6 { [%clk 0:02:38] } 1-0\n"
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: POST api/games/export/_ids
                    assertEquals("api/games/export/_ids", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("POST"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/x-chess-pgn"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.gamesExportIds(body = "mock")

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Add specific field assertions here

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testGamesexportids_example1() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "id": "TJxUmbWK",
                            "rated": true,
                            "variant": "standard",
                            "speed": "rapid",
                            "perf": "rapid",
                            "createdAt": 1504125627542,
                            "lastMoveAt": 1504126012148,
                            "status": "resign",
                            "source": "arena",
                            "players": {
                                        "white": {
                                                    "user": {
                                                                "name": "arex",
                                                                "patron": true,
                                                                "patronColor": 10,
                                                                "id": "arex"
                                                    },
                                                    "rating": 1627,
                                                    "ratingDiff": 15
                                        },
                                        "black": {
                                                    "user": {
                                                                "name": "JERC-12Jesus",
                                                                "id": "jerc-12jesus"
                                                    },
                                                    "rating": 1740,
                                                    "ratingDiff": -15
                                        }
                            },
                            "winner": "white",
                            "opening": {
                                        "eco": "B07",
                                        "name": "Pirc Defense",
                                        "ply": 6
                            },
                            "moves": "e4 d6 d4 Nf6 Nc3 g6 Bd3 Bg7 Be3 O-O Qd2 Ng4 O-O-O Nxe3 Qxe3 Nd7 f4 Nf6 h3 c6 g4 Qb6 Nf3 c5 dxc5 Qxc5 Qxc5 dxc5 e5 Nd7 Nd5 e6 Ne7+ Kh8 Bb5 a6 Bxd7 Bxd7 Rxd7 Rfe8 Rxb7",
                            "tournament": "Xg7M4och",
                            "clock": {
                                        "initial": 600,
                                        "increment": 0,
                                        "totalTime": 600
                            },
                            "division": {
                                        "middle": 22
                            }
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: POST api/games/export/_ids
                    assertEquals("api/games/export/_ids", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("POST"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/x-ndjson"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.gamesExportIds(body = "mock")

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: id
            // Verify field: rated
            // Verify field: variant

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testGamesbyusers() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                [
                            {
                                        "id": "A5fcMO3k",
                                        "rated": true,
                                        "variant": "standard",
                                        "speed": "bullet",
                                        "perf": "bullet",
                                        "createdAt": 1525789431889,
                                        "status": 20,
                                        "statusName": "started",
                                        "clock": {
                                                    "initial": 60,
                                                    "increment": 0,
                                                    "totalTime": 60
                                        },
                                        "players": {
                                                    "white": {
                                                                "userId": "kastorcito",
                                                                "rating": 2617
                                                    },
                                                    "black": {
                                                                "userId": "er_or",
                                                                "rating": 2288
                                                    }
                                        }
                            },
                            {
                                        "id": "A5fcMO3k",
                                        "rated": true,
                                        "variant": "standard",
                                        "speed": "bullet",
                                        "perf": "bullet",
                                        "createdAt": 1525789431889,
                                        "status": 31,
                                        "statusName": "resign",
                                        "clock": {
                                                    "initial": 60,
                                                    "increment": 0,
                                                    "totalTime": 60
                                        },
                                        "players": {
                                                    "white": {
                                                                "userId": "kastorcito",
                                                                "rating": 2617
                                                    },
                                                    "black": {
                                                                "userId": "er_or",
                                                                "rating": 2288
                                                    }
                                        },
                                        "winner": "white"
                            }
                ]
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: POST api/stream/games-by-users
                    assertEquals("api/stream/games-by-users", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("POST"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/x-ndjson"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.gamesByUsers(body = "mock")

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Add specific field assertions here

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testGamesbyids() =
        runTest {
            val streamId = "mock"
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                [
                            {
                                        "id": "A5fcMO3k",
                                        "rated": true,
                                        "variant": "standard",
                                        "speed": "bullet",
                                        "perf": "bullet",
                                        "createdAt": 1525789431889,
                                        "status": 20,
                                        "statusName": "started",
                                        "clock": {
                                                    "initial": 60,
                                                    "increment": 0,
                                                    "totalTime": 60
                                        },
                                        "players": {
                                                    "white": {
                                                                "userId": "kastorcito",
                                                                "rating": 2617
                                                    },
                                                    "black": {
                                                                "userId": "er_or",
                                                                "rating": 2288
                                                    }
                                        }
                            },
                            {
                                        "id": "A5fcMO3k",
                                        "rated": true,
                                        "variant": "standard",
                                        "speed": "bullet",
                                        "perf": "bullet",
                                        "createdAt": 1525789431889,
                                        "status": 31,
                                        "statusName": "resign",
                                        "clock": {
                                                    "initial": 60,
                                                    "increment": 0,
                                                    "totalTime": 60
                                        },
                                        "players": {
                                                    "white": {
                                                                "userId": "kastorcito",
                                                                "rating": 2617
                                                    },
                                                    "black": {
                                                                "userId": "er_or",
                                                                "rating": 2288
                                                    }
                                        },
                                        "winner": "white"
                            }
                ]
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: POST api/stream/games/${streamId}
                    assertEquals("api/stream/games/$streamId", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("POST"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/x-ndjson"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.gamesByIds(streamId = "mock", body = "mock")

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Add specific field assertions here

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testGamesbyidsaddNotImplemented() {
        // TODO: No examples found in OpenAPI spec for this endpoint
        // Endpoint: POST api/stream/games/${streamId}/add
        // Service method: GamesService.gamesByIdsAdd()
        // This test is skipped until examples are available in the OpenAPI specification
    }

    @Test
    fun testAccountplaying() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "nowPlaying": [
                                        {
                                                    "gameId": "rCRw1AuO",
                                                    "fullId": "rCRw1AuOvonq",
                                                    "color": "black",
                                                    "fen": "r1bqkbnr/pppp2pp/2n1pp2/8/8/3PP3/PPPB1PPP/RN1QKBNR w KQkq - 2 4",
                                                    "hasMoved": true,
                                                    "isMyTurn": false,
                                                    "lastMove": "b8c6",
                                                    "opponent": {
                                                                "id": "philippe",
                                                                "rating": 1790,
                                                                "username": "Philippe"
                                                    },
                                                    "perf": "correspondence",
                                                    "rated": false,
                                                    "secondsLeft": 1209600,
                                                    "source": "friend",
                                                    "speed": "correspondence",
                                                    "variant": {
                                                                "key": "standard",
                                                                "name": "Standard"
                                                    }
                                        }
                            ]
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/account/playing
                    assertEquals("api/account/playing", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/json"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.accountPlaying()

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: nowPlaying

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testStreamgame() =
        runTest {
            val id = "mock"
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                [
                            {
                                        "id": "LuGQwhBb",
                                        "variant": {
                                                    "key": "standard",
                                                    "name": "Standard",
                                                    "short": "Std"
                                        },
                                        "speed": "blitz",
                                        "perf": "blitz",
                                        "rated": true,
                                        "initialFen": "rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",
                                        "fen": "rnbqkb1r/1p1ppppp/p6n/2p4Q/8/1P2P3/P1PP1PPP/RNB1KBNR w KQkq - 0 4",
                                        "player": "white",
                                        "turns": 6,
                                        "startedAtTurn": 0,
                                        "source": "pool",
                                        "status": {
                                                    "id": 20,
                                                    "name": "started"
                                        },
                                        "createdAt": 1620029815106,
                                        "lastMove": "c7c5",
                                        "players": {
                                                    "white": {
                                                                "user": {
                                                                            "name": "ARM-777777",
                                                                            "title": "GM",
                                                                            "id": "arm-777777"
                                                                },
                                                                "rating": 3120
                                                    },
                                                    "black": {
                                                                "user": {
                                                                            "name": "Flash_Marafon",
                                                                            "id": "flash_marafon"
                                                                },
                                                                "rating": 3015
                                                    }
                                        }
                            },
                            {
                                        "fen": "rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w",
                                        "wc": 180,
                                        "bc": 180
                            },
                            {
                                        "fen": "rnbqkbnr/pppppppp/8/8/8/4P3/PPPP1PPP/RNBQKBNR b",
                                        "lm": "e2e3",
                                        "wc": 180,
                                        "bc": 180
                            },
                            {
                                        "fen": "rnbqkb1r/pppppppp/7n/8/8/4P3/PPPP1PPP/RNBQKBNR w",
                                        "lm": "g8h6",
                                        "wc": 180,
                                        "bc": 180
                            },
                            {
                                        "fen": "rnbqkb1r/pppppppp/7n/8/8/1P2P3/P1PP1PPP/RNBQKBNR b",
                                        "lm": "b2b3",
                                        "wc": 177,
                                        "bc": 180
                            },
                            {
                                        "fen": "rnbqkb1r/1ppppppp/p6n/8/8/1P2P3/P1PP1PPP/RNBQKBNR w",
                                        "lm": "a7a6",
                                        "wc": 177,
                                        "bc": 177
                            }
                ]
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/stream/game/${id}
                    assertEquals("api/stream/game/$id", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/x-ndjson"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.streamGame(id = "mock")

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Add specific field assertions here

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testGameimport() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                {
                            "id": "R6iLjwz5",
                            "url": "https://lichess.org/R6iLjwz5"
                }
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: POST api/import
                    assertEquals("api/import", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("POST"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/json"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.gameImport()

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Verify field: id
            // Verify field: url

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testImportedgamesuser() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                "[Event \"Rated Blitz game\"]\n[Site \"https://lichess.org/fY44h4OY\"]\n[Date \"2018.03.29\"]\n[Round \"-\"]\n[White \"pveldman\"]\n[Black \"thibault\"]\n[Result \"1-0\"]\n[UTCDate \"2018.03.29\"]\n[UTCTime \"01:38:15\"]\n[WhiteElo \"1610\"]\n[BlackElo \"1601\"]\n[WhiteRatingDiff \"+10\"]\n[BlackRatingDiff \"-10\"]\n[Variant \"Standard\"]\n[TimeControl \"180+0\"]\n[ECO \"C62\"]\n[Opening \"Ruy Lopez: Steinitz Defense\"]\n[Termination \"Normal\"]\n\n1. e4 { [%clk 0:03:00] } e5 { [%clk 0:03:00] } 2. Nf3 { [%clk 0:02:59] } Nc6 { [%clk 0:02:58] } 3. Bb5 { [%clk 0:02:57] } d6 { [%clk 0:02:55] } 4. h3 { [%clk 0:02:54] } Nf6 { [%clk 0:02:52] } 5. Bxc6+ { [%clk 0:02:52] } bxc6 { [%clk 0:02:49] } 6. d3 { [%clk 0:02:51] } Be7 { [%clk 0:02:46] } 7. O-O { [%clk 0:02:47] } O-O { [%clk 0:02:45] } 8. b3 { [%clk 0:02:45] } d5 { [%clk 0:02:45] } 9. exd5 { [%clk 0:02:33] } cxd5 { [%clk 0:02:40] } 10. Nxe5 { [%clk 0:02:31] } Qd6 { [%clk 0:02:38] } 1-0\n"
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/games/export/imports
                    assertEquals("api/games/export/imports", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/x-chess-pgn"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.importedGamesUser()

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Add specific field assertions here

            // Cleanup
            testApiClient.close()
        }

    @Test
    fun testExportbookmarks() =
        runTest {
            // Arrange - Mock HTTP response
            val mockResponse =
                """
                "[Event \"Rated Blitz game\"]\n[Site \"https://lichess.org/fY44h4OY\"]\n[Date \"2018.03.29\"]\n[Round \"-\"]\n[White \"pveldman\"]\n[Black \"thibault\"]\n[Result \"1-0\"]\n[UTCDate \"2018.03.29\"]\n[UTCTime \"01:38:15\"]\n[WhiteElo \"1610\"]\n[BlackElo \"1601\"]\n[WhiteRatingDiff \"+10\"]\n[BlackRatingDiff \"-10\"]\n[Variant \"Standard\"]\n[TimeControl \"180+0\"]\n[ECO \"C62\"]\n[Opening \"Ruy Lopez: Steinitz Defense\"]\n[Termination \"Normal\"]\n\n1. e4 { [%clk 0:03:00] } e5 { [%clk 0:03:00] } 2. Nf3 { [%clk 0:02:59] } Nc6 { [%clk 0:02:58] } 3. Bb5 { [%clk 0:02:57] } d6 { [%clk 0:02:55] } 4. h3 { [%clk 0:02:54] } Nf6 { [%clk 0:02:52] } 5. Bxc6+ { [%clk 0:02:52] } bxc6 { [%clk 0:02:49] } 6. d3 { [%clk 0:02:51] } Be7 { [%clk 0:02:46] } 7. O-O { [%clk 0:02:47] } O-O { [%clk 0:02:45] } 8. b3 { [%clk 0:02:45] } d5 { [%clk 0:02:45] } 9. exd5 { [%clk 0:02:33] } cxd5 { [%clk 0:02:40] } 10. Nxe5 { [%clk 0:02:31] } Qd6 { [%clk 0:02:38] } 1-0\n"
                """.trimIndent()

            val mockEngine =
                MockEngine { request ->
                    // Verify request matches expected endpoint: GET api/games/export/bookmarks
                    assertEquals("api/games/export/bookmarks", request.url.encodedPath.trimStart('/'))
                    assertEquals(HttpMethod.parse("GET"), request.method)

                    respond(
                        content = ByteReadChannel(mockResponse),
                        status = HttpStatusCode.fromValue(200),
                        headers = headersOf(HttpHeaders.ContentType, "application/x-chess-pgn"),
                    )
                }

            // Create mock HttpClient with proper configuration
            val mockHttpClient =
                HttpClient(mockEngine) {
                    install(ContentNegotiation) {
                        json(
                            Json {
                                ignoreUnknownKeys = true
                                coerceInputValues = true
                                explicitNulls = false
                            },
                        )
                    }
                }

            // Create service with mocked client
            val testApiClient =
                BaseApiClient(
                    baseUrl = "https://lichess.org",
                    token = "test_token",
                    httpClient = mockHttpClient,
                )
            val testService = GamesService(testApiClient)

            // Act
            val result = testService.exportBookmarks()

            // Assert
            assertTrue(result.isSuccess, "API call should succeed")
            val response = result.getOrNull()
            assertNotNull(response, "Response should not be null")
            // Add specific field assertions here

            // Cleanup
            testApiClient.close()
        }
}
